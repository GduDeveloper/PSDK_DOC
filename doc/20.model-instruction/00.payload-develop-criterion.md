---
title: 负载开发标准
date: 2023-05-03
---


为确保无人机在搭载负载设备执行飞行任务时的安全，请在使用PSDK 开发负载设备时，遵循GDU 的负载设备开发标准。

## 硬件接口标准


## 干扰兼容性要求

## 结构设计标准

## 自定义数据传输标准

##### 使用S400系列

| 通道类型                | 传输方向             | 速率限制                                                |
| ----------------------- | -------------------- | ------------------------------------------------------- |
| 命令通道                | 移动端App ➟ 负载设备 | ≤4096B/s                                                |
| 负载设备 ➟ 移动端App    |                      |                                                         |
| 用户负载设备 ➟ 负载设备 |                      |                                                         |
| 负载设备 ➟ 用户负载设备 |                      |                                                         |
| 高速数据传输通道        | 负载设备 ➟ 移动端App | 单云台：≤ 8192Kbps 多云台：每个云台的传输速率≤ 4096Kbps |

## 视频流传输标准

使用PSDK 开发的**相机类**负载设备，**必须**选用如下的两种**H.264 编码标准**。

**Custom-H264** 标准

#### 特性

1. 较为通用且更易获取的标准H264格式码流。
2. 使用该视频流格式发送码流时，会通过飞机透传到App端解码，且实时码率不得超过反馈值。
3. 使用该格式传输视频流，SEI的内容可传输到App端。

#### 要求

基于PSDK 开发的**相机类**负载设备，在使用**Custom-H264 标准**时，需注意如下关键配置信息：

| 关键项                                 | H.264 标准项        | 取值                                                         |
| -------------------------------------- | ------------------- | ------------------------------------------------------------ |
| 视频分辨率                             | -                   | 最大不超过 1920 × 1080                                       |
| 帧率                                   | -                   | 最大不超过 30 fps                                            |
| 码率                                   | -                   | 最大不超过 8 Mbps                                            |
| 推荐视频长宽比                         | -                   | 4: 3                                                         |
| GOP 编码结构必须选用Period I           | -                   | -                                                            |
| 档次                                   | Level Number        | ＜5.1                                                        |
| profile_idc                            | 7.3.2.1.1           | Baseline=66，Main=77，High=100                               |
| YUV420 格式                            | 7.3.2.1.1           | chroma_format_idc=1                                          |
| 8Bit 视频                              | 7.3.2.1.1           | bit_depth_luma_minus8=0 bit_depth_chroma_minus8=0            |
| 不允许编码器自定义 Scaling Matrix      | 7.3.2.1.1 7.3.2.2   | seq_scaling_matrix_present_flag=0 pic_scaling_matrix_present_flag=0 |
| 仅支持帧格式编码，不支持场编码         | 7.3.2.1.1           | frames_mbs_only_flag=1                                       |
| 仅允许 P 帧和 I 帧，且P 帧有单个参考帧 | 7.3.3 7.3.2.2 7.3.3 | slice_type = 0 或 2 num_ref_idx_l0_default_active_minus1=0 num_ref_idx_active_override_flag=0 |
| 不支持多Slice Group                    | 7.3.2.2             | num_slice_groups_minus1=0                                    |

> **注意：** 使用H.264 编码标准时，GOP 编码结构必须选用Period I（帧内编码帧，每隔1 秒将插入1 个IDR 帧，确保图像数据丢失时可被恢复）。

**GDU-H264** 标准

#### 特性

1. 较为严苛的GDU H264格式码流标准。
2. 使用该视频流格式发送码流时，会通过飞机转码，在最大码率限制内，能够根据实时图传链路的情况，动态调节码率，达到最优的图传显示效果。
3. 使用该格式传输视频流，SEI的内容会被飞机丢弃，无法传输到App端。

#### 要求

基于PSDK 开发的**相机类**负载设备，在使用**GDU-H264 标准**时，需注意如下关键配置信息：

| 关键项                                           | H.264 标准项        | 取值                                                         |
| ------------------------------------------------ | ------------------- | ------------------------------------------------------------ |
| 视频分辨率                                       | -                   | 最大不超过 1920 × 1080                                       |
| 帧率                                             | -                   | 最大不超过 30fps                                             |
| 码率                                             | -                   | 最大不超过 8 Mbps                                            |
| 每一帧结尾必须加上AUD信息                        | -                   | 固定6字节：0x00 0x00 0x00 0x01 0x09 0x10                     |
| 推荐视频长宽比                                   | -                   | 4:3或16: 9                                                   |
| 一帧数据字节数                                   | -                   | 最大不超过 256KBytes                                         |
| 档次                                             | Level Number        | ＜5.1                                                        |
| profile_idc                                      | 7.3.2.1.1           | Baseline=66，Main=77，High=100                               |
| YUV420 格式                                      | 7.3.2.1.1           | chroma_format_idc=1                                          |
| 8Bit 视频                                        | 7.3.2.1.1           | bit_depth_luma_minus8=0 bit_depth_chroma_minus8=0            |
| 不允许编码器自定义 Scaling Matrix                | 7.3.2.1.1 7.3.2.2   | seq_scaling_matrix_present_flag=0 pic_scaling_matrix_present_flag=0 |
| 仅支持帧格式编码，不支持场编码                   | 7.3.2.1.1           | frames_mbs_only_flag=1                                       |
| 仅允许 P 帧和 I 帧，且P 帧有单个参考帧           | 7.3.3 7.3.2.2 7.3.3 | slice_type = 0 或 2 num_ref_idx_l0_default_active_minus1=0 num_ref_idx_active_override_flag=0 |
| 不支持多Slice Group                              | 7.3.2.2             | num_slice_groups_minus1=0                                    |
| 不支持长期参考帧                                 | 7.3.3.3             | long_term_reference_flag=0                                   |
| 要求解码顺序和播放顺序一致                       | E.1.1               | max_num_reorder_frames=0                                     |
| 限制解码的参考帧数量为5                          | E.1.1               | max_dec_frame_buffering=5                                    |
| 支持最大的参考帧个数为1帧，支持最大的参考间隔为1 | 7.3.2.1.1           | max_num_ref_frames=1                                         |

> **注意：**
>
> - 使用H.264 编码标准时，Gop structure 可选，为Period I或者GDR。
> - 如果是Period Ⅰ，要求每个I帧为IDR帧，若不符合要求，则不保证图传能够从丢包错误中正确恢复；在发送完SPS/PPS之后，需要立马传输Ⅰ帧的流，然后再传输AUD，在SPS/PPS和slice之间无AUD信息。Period Ⅰ结构中，建议一秒一个IDR。
> - 如果为GDR，在每个GDR刷新帧需要传输sps/pps。

> **兼容性说明：** 若视频流格式设置为**GDU H264** 格式，数据流传输功能将无法使用，建议切换到SDK 互联互通功能使用。

> **相关参考：** H.264 协议标准

> **视频流检测工具：** 码流检测工具
